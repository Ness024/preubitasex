<div class="contenedor">
  <h3 class="title-status">
    <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path d="M16 6H3V9H16V11L21 7.5L16 4V6Z" fill="#00AEEF" />
      <path d="M8 18H21V15H8V13L3 16.5L8 20V18Z" fill="#00AEEF" />
    </svg>
    Cambiar el Status del Documento
  </h3>
  <h5 style="padding-left: 10px;">Seleccione el nuevo estatus para el documento #REF-2023-0458</h5>
  <section class="checkbox-contenedor">
    @for (estado of estados; track estado.id) {
    <div class="checkbox-wrapper-16"> <label class="checkbox-wrapper"
        [matTooltip]="getTooltipText(estado.id)"
        matTooltipPosition="above"
        [matTooltipClass]="getStatusColorClass(estado.id)">
        <input type="radio" class="checkbox-input" name="status" [value]="estado.id"
          [checked]="estado.id === currentStatusId" (change)="selectstatus($event)" />
        <span class="checkbox-tile" [style.--color]="getStatusColor(estado.id)">
          <span class="checkbox-icon">
            <!----------------------iconito segun estadito xD-->
            <ng-container [ngSwitch]="estado.id">
              <svg *ngSwitchCase="'received'" xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"
                viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="M5 22q-.825 0-1.412-.587T3 20v-4.55l2.75-3.125l1.425 1.425l-2 2.25h13.65l-1.95-2.2l1.425-1.425L21 15.45V20q0 .825-.587 1.413T19 22zm0-2h14v-2H5zm5.625-5.625L7.1 10.85q-.575-.575-.562-1.412t.587-1.413l4.9-4.9q.575-.575 1.425-.6t1.425.55L18.4 6.6q.575.575.6 1.4t-.55 1.4l-5 5q-.575.575-1.412.563t-1.413-.588M17 8.025L13.475 4.5l-4.95 4.95l3.525 3.525zM5 20v-2z" />
              </svg>

              <svg *ngSwitchCase="'in_process'" xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"
                viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="M3 5.25A2.25 2.25 0 0 1 5.25 3h9.5A2.25 2.25 0 0 1 17 5.25V14h4v3.75A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75zM17 19.5h.75a1.75 1.75 0 0 0 1.75-1.75V15.5H17zM5.25 4.5a.75.75 0 0 0-.75.75v12.5c0 .966.784 1.75 1.75 1.75h9.25V5.25a.75.75 0 0 0-.75-.75zm2 2.5a.75.75 0 0 0 0 1.5h5.5a.75.75 0 0 0 0-1.5zm-.75 4.75a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1-.75-.75M7.25 15a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5z" />
              </svg>

              <svg *ngSwitchCase="'in_signing'" xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"
                viewBox="0 0 24 24">
                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                  stroke-width="1.5"
                  d="m7.63 7.63l3.006 3.006M3.042 4.34l2.616 9.157c.778 2.723 2.933 4.6 5.764 4.6a5.6 5.6 0 0 0 1.264-.148c.392-.09.812-.001 1.097.283l2.46 2.46c.41.41 1.075.41 1.485 0l2.964-2.965a1.05 1.05 0 0 0 0-1.486l-2.455-2.455c-.284-.284-.373-.703-.284-1.094q.143-.624.145-1.27c0-2.832-1.877-4.987-4.6-5.765L4.341 3.042a1.05 1.05 0 0 0-1.3 1.299" />
              </svg>

              <svg *ngSwitchCase="'in_signed'" xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"
                viewBox="0 0 24 24">
                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2">
                  <path d="m9 10l3.258 2.444a1 1 0 0 0 1.353-.142L20 5" />
                  <path d="M21 12a9 9 0 1 1-6.67-8.693" />
                </g>
              </svg>

              <svg *ngSwitchCase="'completed'" xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"
                viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="m10.6 16.6l7.05-7.05l-1.4-1.4l-5.65 5.65l-2.85-2.85l-1.4 1.4zM12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22" />
              </svg>

              <svg *ngSwitchCase="'delivered'" xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"
                viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="M19 7h-3V6a4 4 0 0 0-8 0v1H5a1 1 0 0 0-1 1v11a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V8a1 1 0 0 0-1-1M8 6a2 2 0 0 1 4 0v1H8zm8 14H6a1 1 0 0 1-1-1V9h14v10a1 1 0 0 1-1 1m-3-4a1 1 0 0 1-1 1h-4a1 1 0 0 1 0-2h4a1 1 0 0 1 1 1" />
              </svg>

              <svg *ngSwitchCase="'archived'" xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"
                viewBox="0 0 24 24">
                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                  color="currentColor">
                  <path
                    d="M21 7v5M3 7v10.161c0 1.383 1.946 2.205 5.837 3.848C10.4 21.67 11.182 22 12 22V11.355M15 19s.875 0 1.75 2c0 0 2.78-5 5.25-6" />
                  <path
                    d="M8.326 9.691L5.405 8.278C3.802 7.502 3 7.114 3 6.5s.802-1.002 2.405-1.778l2.92-1.413C10.13 2.436 11.03 2 12 2s1.871.436 3.674 1.309l2.921 1.413C20.198 5.498 21 5.886 21 6.5s-.802 1.002-2.405 1.778l-2.92 1.413C13.87 10.564 12.97 11 12 11s-1.871-.436-3.674-1.309M6 12l2 1m9-9L7 9" />
                </g>
              </svg>

              <svg *ngSwitchCase="'cancelled'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                  stroke-miterlimit="10" stroke-width="1.5"
                  d="M20 22H8.4C5.42 22 3 19.58 3 16.6V5m13.828 8.828l-5.656-5.656m5.656 0l-5.656 5.656M8.4 3h11.2A2.4 2.4 0 0 1 22 5.4v11.2a2.4 2.4 0 0 1-2.4 2.4H8.4A2.4 2.4 0 0 1 6 16.6V5.4A2.4 2.4 0 0 1 8.4 3" />
              </svg>
            </ng-container>
          </span>
          <span class="checkbox-label">{{ estado.name }}</span>
        </span>
      </label>
    </div>
    }
  </section>
  @if (contenidoModal !== "" && currentStatusId === statusForm.value.status_id) {
  <form [formGroup]="statusForm">
    <div formGroupName="form" class="inputs-section" [style.--color]="getStatusColor(currentStatusId)">
      @switch (currentStatusId) {
      @case ('received'){
      <h5>Información de recepción</h5>
      <fieldset class="form-group date_registration">
        <label for="received_date">Fecha de Recepcion</label>
        <input class="input-form" type="date" id="issue_date" name="received_date" formControlName="received_date"
          [class.is-invalid]="getFormControl('received_date')?.invalid &&
                            (getFormControl('received_date')?.touched || formSubmitted)" />

        <app-form-input-error [control]="getFormControl('received_date')!" [errorMessages]="errorMessages.received_date"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>

      </fieldset>
      <fieldset class="form-group type">
        <label for="received_by">Recibido por:</label>
        <input class="input-form" type="text" formControlName="received_by" placeholder="Nombre de quien recibió"
          [class.is-invalid]="getFormControl('received_by')?.invalid &&
                            (getFormControl('received_by')?.touched || formSubmitted)" />

        <app-form-input-error [control]="getFormControl('received_by')!" [errorMessages]="errorMessages.received_by"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>

      </fieldset>
      }
      @case ('in_process'){
      <h5>Información del trámite</h5>
      <fieldset class="form-group type">
        <label for="responsible"> Responsable:</label>
        <input class="input-form" type="text" formControlName="responsible" placeholder="Nombre del responsable"
          [class.is-invalid]="getFormControl('responsible')?.invalid &&
                            (getFormControl('responsible')?.touched || formSubmitted)" />

        <app-form-input-error [control]="getFormControl('responsible')!" [errorMessages]="errorMessages.responsible"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group type">
        <label for="department">Departamento Asignado</label>
        <select class="input-form" id="receiver_department_id" name="department" formControlName="department"
          [class.is-invalid]="getFormControl('department')?.invalid &&
          (getFormControl('department')?.touched || formSubmitted)">>
          <option value="" disabled selected>Seleccione...</option>
          @for (department of departments; track department.id){
          <option [value]="department.id">{{department.name}}</option>
          }
        </select>
        <app-form-input-error [control]="getFormControl('department')!" [errorMessages]="errorMessages.department"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <!-- Descripción -->
      <fieldset class="form-group description">
        <label for="description">Descripción del trámite</label>
        <textarea class="input-form" id="description" name="description" rows="4" formControlName="description"
          placeholder="Describa brevemente el trámite a realizar"></textarea>
      </fieldset>
      <div class="aviso">
        <div class="svgcontainer">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <g fill="none">
              <path fill="currentColor" fill-opacity=".16"
                d="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2" />
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"
                stroke-width="1.5"
                d="M12 16h.008M12 8v5m10-1c0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10s10-4.477 10-10" />
            </g>
          </svg>
        </div>
        <p>Este documento puede iniciar un trámite que involucra un nuevo oficio. ¿Desea registrar un documento de
          seguimiento?</p>
        <form [formGroup]="followUpOptionForm" class="followup-options">
          <label class="followup-option">
            <input type="radio" name="followUpOption" class="followup-input" formControlName="followUpOption"
              value="Si">
            <span class="followup-checkbox"></span>
            <span>Sí, crear documento relacionado</span>
          </label>
          <label class="followup-option">
            <input type="radio" name="followUpOption" class="followup-input" formControlName="followUpOption" value="No"
              checked>
            <span class="followup-checkbox"></span>
            <span>No, solo cambiar estatus</span>
          </label>
        </form>
      </div>
      }
      @case ('in_signing'){
      <h5>Información de firma</h5>
      <fieldset class="form-group type">
        <label for="sent_to">Enviado para:</label>
        <input class="input-form" type="text" formControlName="sent_to" placeholder="Nombre del firmante"
          [class.is-invalid]="getFormControl('sent_to')?.invalid &&
                            (getFormControl('sent_to')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('sent_to')!" [errorMessages]="errorMessages.sent_to"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group type">
        <label for="position">Cargo:</label>
        <input class="input-form" type="text" formControlName="position" placeholder="Cargo del firmante"
          [class.is-invalid]="getFormControl('position')?.invalid &&
                            (getFormControl('position')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('position')!" [errorMessages]="errorMessages.position"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group date_registration">
        <label for="deadline_date">Fecha limite de firma:</label>
        <input class="input-form" type="date" id="issue_date" name="deadline_date" formControlName="deadline_date"
          [class.is-invalid]="getFormControl('deadline_date')?.invalid &&
                            (getFormControl('deadline_date')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('deadline_date')!" [errorMessages]="errorMessages.deadline_date"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      }
      @case ('in_signed'){
      <h5>Información de documento firmado</h5>
      <fieldset class="form-group type">
        <label for="concluded_by">Firmado por:</label>
        <input class="input-form" type="text" formControlName="concluded_by" placeholder="Nombre del firmante"
          [class.is-invalid]="getFormControl('concluded_by')?.invalid &&
                            (getFormControl('concluded_by')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('concluded_by')!" [errorMessages]="errorMessages.signed_by"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group date_registration type">
        <label for="signing_date">Fecha de Firma</label>
        <input class="input-form" type="date" id="issue_date" name="signing_date" formControlName="signing_date"
          [class.is-invalid]="getFormControl('signing_date')?.invalid &&
                            (getFormControl('signing_date')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('signing_date')!" [errorMessages]="errorMessages.signing_date"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <!-- Descripción -->
      <fieldset class="form-group description">
        <label for="conclusion_notes">Observaciones</label>
        <textarea class="input-form" id="description" name="conclusion_notes" formControlName="conclusion_notes"
          rows="4" placeholder="Descripción del documento"></textarea>
      </fieldset>
      }
      @case ('completed'){
      <h5>Información de conclusión</h5>
      <fieldset class="form-group type">
        <label for="concluded_by">Concluido por:</label>
        <input class="input-form" type="text" formControlName="concluded_by" placeholder="Nombre de quien concluye"
          [class.is-invalid]="getFormControl('concluded_by')?.invalid &&
                            (getFormControl('concluded_by')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('concluded_by')!" [errorMessages]="errorMessages.concluded_by"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group date_registration type">
        <label for="conclusion_date">Fecha de conclusión</label>
        <input class="input-form" type="date" id="conclusion_date" name="conclusion_date"
          formControlName="conclusion_date" [class.is-invalid]="getFormControl('conclusion_date')?.invalid &&
                            (getFormControl('conclusion_date')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('conclusion_date')!"
          [errorMessages]="errorMessages.conclusion_date" [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <!-- Descripción -->
      <fieldset class="form-group description">
        <label for="conclusion_notes">Notas de conclusión</label>
        <textarea class="input-form" id="conclusion_notes" name="conclusion_notes" formControlName="conclusion_notes"
          rows="4" placeholder="Detalles sobre la conclusión del documento"></textarea>
      </fieldset>
      }
      @case ('delivered'){
      <h5>Información de entrega</h5>
      <fieldset class="form-group type">
        <label for="delivered_by">Entregado por:</label>
        <input class="input-form" type="text" formControlName="delivered_by" placeholder="Nombre de quien entrega"
          [class.is-invalid]="getFormControl('delivered_by')?.invalid &&
                            (getFormControl('delivered_by')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('delivered_by')!" [errorMessages]="errorMessages.delivered_by"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group type">
        <label for="delivery_to">Entregado a:</label>
        <input class="input-form" type="text" formControlName="delivery_to" placeholder="Nombre del destinatario"
          [class.is-invalid]="getFormControl('delivery_to')?.invalid &&
                            (getFormControl('delivery_to')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('delivery_to')!" [errorMessages]="errorMessages.delivery_to"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group date_registration type">
        <label for="delivery_date">Fecha de entrega</label>
        <input class="input-form" type="date" id="delivery_date" name="delivery_date" formControlName="delivery_date"
          [class.is-invalid]="getFormControl('delivery_date')?.invalid &&
                            (getFormControl('delivery_date')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('delivery_date')!" [errorMessages]="errorMessages.delivery_date"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <!-- Descripción -->
      <fieldset class="form-group description">
        <label for="delivery_notes">Notas de entrega (opcional)</label>
        <textarea class="input-form" id="delivery_notes" name="delivery_notes" formControlName="delivery_notes" rows="4"
          placeholder="Detalles sobre la entrega"></textarea>
      </fieldset>
      }
      @case ('archived'){
      <h5>Información de archivo</h5>
      <fieldset class="form-group date_registration type">
        <label for="archived_date">Fecha de archivo</label>
        <input class="input-form" type="date" id="issue_date" name="archived_date" formControlName="archived_date"
          [class.is-invalid]="getFormControl('archived_date')?.invalid &&
                            (getFormControl('archived_date')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('archived_date')!" [errorMessages]="errorMessages.archived_date"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group type">
        <label for="archived_by">Archivado por</label>
        <input class="input-form" type="text" formControlName="archived_by" placeholder="Nombre de quien archiva"
          [class.is-invalid]="getFormControl('archived_by')?.invalid &&
                            (getFormControl('archived_by')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('archived_by')!" [errorMessages]="errorMessages.archived_by"
          [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>

      <!-- Descripción -->
      <fieldset class="form-group description">
        <label for="archived_file_location">Ubicacion fisica (opcional)</label>
        <input type="text" class="input-form" formControlName="archived_file_location"
          placeholder="Descripcion de la Ubicacion fisica del documento">
      </fieldset>
      }
      @case ('cancelled'){
      <h5>Información de cancelación</h5>
      <fieldset class="form-group date_registration type">
        <label for="cancellation_date">Fecha de cancelación</label>
        <input class="input-form" type="date" id="issue_date" name="cancellation_date"
          formControlName="cancellation_date" [class.is-invalid]="getFormControl('cancellation_date')?.invalid &&
                            (getFormControl('cancellation_date')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('cancellation_date')!"
          [errorMessages]="errorMessages.cancellation_date" [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group type">
        <label for="cancellation_reason">Motivo de Cancelación</label>
        <input type="text" class="input-form" formControlName="cancellation_reason" placeholder="Motivo"
          [class.is-invalid]="getFormControl('cancellation_reason')?.invalid &&
                            (getFormControl('cancellation_reason')?.touched || formSubmitted)">
        <app-form-input-error [control]="getFormControl('cancellation_reason')!"
          [errorMessages]="errorMessages.cancellation_reason" [showOnSubmit]="formSubmitted">
        </app-form-input-error>
      </fieldset>
      <fieldset class="form-group description">
        <label for="cancellation_notes">Nota (opcional)</label>
        <textarea class="input-form" id="description" name="cancellation_notes" rows="4"
          formControlName="cancellation_notes" placeholder="Descripción detallada del motivo de cancelación"></textarea>
      </fieldset>
      }

      }
    </div>
    <fieldset class="form-group description comentarios">
      <label for="description">Comentario adicional (opcional)</label>
      <textarea class="input-form" id="description" name="comment" rows="4" maxlength="255"
        placeholder="Añade un comentario sobre este cambio de estatus..."
        formControlName="comment">
      </textarea>

    </fieldset>

    <fieldset class="form-group description" style="margin-bottom: 0;">
      @if (this.followUpOptionForm.value.followUpOption === 'Si') {
      <button class="button-24" (click)="continueToDocument()" role="button">
        Continuar
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
          <path fill="currentColor" d="M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6l-1.41-1.42z" />
        </svg>
      </button>
      }
      @else {
      <button class="button-24" (click)="handleSave()" role="button">
        Guardar
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 1024 1024">
          <path fill="currentColor"
            d="M512 0C229.232 0 0 229.232 0 512c0 282.784 229.232 512 512 512c282.784 0 512-229.216 512-512C1024 229.232 794.784 0 512 0m0 961.008c-247.024 0-448-201.984-448-449.01c0-247.024 200.976-448 448-448s448 200.977 448 448s-200.976 449.01-448 449.01m204.336-636.352L415.935 626.944l-135.28-135.28c-12.496-12.496-32.752-12.496-45.264 0c-12.496 12.496-12.496 32.752 0 45.248l158.384 158.4c12.496 12.48 32.752 12.48 45.264 0c1.44-1.44 2.673-3.009 3.793-4.64l318.784-320.753c12.48-12.496 12.48-32.752 0-45.263c-12.512-12.496-32.768-12.496-45.28 0" />
        </svg>
      </button>
      }
    </fieldset>
  </form>
  }
</div>
